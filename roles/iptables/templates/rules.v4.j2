# Generated by xtables-save v1.8.2 on Sat Feb  6 18:06:12 2021
*filter
:INPUT DROP [0:0]
:FORWARD DROP [0:0]
:OUTPUT DROP [0:0]
:incoming-ssh - [0:0]
:incoming-local - [0:0]
:incoming-external - [0:0]
:valid-states - [0:0]
:outgoing-services - [0:0]
-A INPUT -i lo -m comment --comment "Accept all on loopback" -j ACCEPT
-A INPUT -m conntrack --ctstate INVALID -j DROP
-A INPUT -j valid-states
-A INPUT -p tcp -m tcp --dport 22 -j incoming-ssh
-A INPUT -p vrrp -m comment --comment VRRP -j incoming-local
-A INPUT -p icmp -m comment --comment ICMP -j incoming-local
-A INPUT -p udp -m udp --dport 53 -m comment --comment DNS -j incoming-local
-A INPUT -p tcp -m tcp --dport 9090 -m comment --comment Prometheus -j incoming-local
-A INPUT -p tcp -m tcp --dport 3000 -m comment --comment Grafana -j incoming-local
-A INPUT -p tcp -m tcp --dport 9000 -m comment --comment HAProxyDashboard -j incoming-local
-A INPUT -p tcp -m multiport --dports 11211,11311 -m comment --comment Memcached -j incoming-local
-A INPUT -p tcp -m multiport --dports 9100,9101,9104,9121,9150,9243 -m comment --comment Exporters -j incoming-local
-A INPUT -p tcp -m multiport --dports 3306,3307,3308,4444,4567,4568,9200 -m comment --comment "MySQL/Galera" -j incoming-local
-A INPUT -p udp -m udp --dport 4567 -m comment --comment "MySQL/Galera" -j incoming-local
-A INPUT -p tcp -m multiport --dports 6379,16379 -m comment --comment Redis -j incoming-local
-A INPUT -p tcp -m multiport --dports 80,443 -m comment --comment Web -j {% if external_connections | default('false') | bool %}incoming-external{% else %}incoming-local{% endif %}{{ "" }}
-A OUTPUT -o lo -m comment --comment "Accept all on loopback" -j ACCEPT
-A OUTPUT -j valid-states
-A OUTPUT -j outgoing-services
-A incoming-ssh -s 192.168.8.0/24 -m conntrack --ctstate NEW,ESTABLISHED -m comment --comment "Local SSH" -j ACCEPT
-A incoming-ssh -s 192.168.9.0/24 -m conntrack --ctstate NEW,ESTABLISHED -m comment --comment "Local VPN SSH" -j ACCEPT
-A incoming-ssh -s 192.168.2.0/24 -m conntrack --ctstate NEW,ESTABLISHED -m comment --comment "Golovanova VPN SSH" -j ACCEPT
-A incoming-ssh -j DROP
-A incoming-local -s 192.168.8.0/24 -m conntrack --ctstate NEW,ESTABLISHED -j ACCEPT
-A incoming-local -j DROP
-A incoming-external -m conntrack --ctstate NEW,ESTABLISHED -j ACCEPT
-A incoming-external -j DROP
-A valid-states -p tcp -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT
-A valid-states -p udp -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT
-A valid-states -p icmp -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT
-A valid-states -p vrrp -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT
-A valid-states -j RETURN
-A outgoing-services -p tcp -j ACCEPT
-A outgoing-services -p udp -j ACCEPT
-A outgoing-services -p icmp -j ACCEPT
-A outgoing-services -p vrrp -j ACCEPT
-A outgoing-services -j DROP
COMMIT
# Completed on Sat Feb  6 18:06:12 2021
